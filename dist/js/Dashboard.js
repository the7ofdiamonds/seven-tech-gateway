import{f as M,g as $e,i as W,c as D,d as w,h as L,k as xe,m as He,n as Qe,u as N,r as h,_ as E,j as s,o as ge,p as We,l as Xe,q as Ye,t as Ze}from"./index.js";import ea from"./Login.js";import{u as de,S as aa}from"./StatusBarComponent.js";import"./NavigationLoginComponent.js";var C={VITE_API_KEY:"AIzaSyBu0CCToizQh2SORCP-4dAmXHJpzB6tU6k",VITE_AUTH_DOMAIN:"theorb-f3a48.firebaseapp.com",VITE_DATABASE_URL:"https://theorb-f3a48.firebaseio.com",VITE_PROJECT_ID:"theorb-f3a48",VITE_STORAGE_BUCKET:"theorb-f3a48.appspot.com",VITE_MESSAGING_SENDER_ID:"1073451047758",VITE_APP_ID:"1:1073451047758:web:ae958815b1fd677e071c1f",VITE_MEASUREMENT_ID:"G-09W10PNNF0",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},ra=C.VITE_BACKEND_URL?C.VITE_BACKEND_URL+"/change-name":"/wp-json/seven-tech/v1/user/change-name",sa=C.VITE_BACKEND_URL?C.VITE_BACKEND_URL+"/change-phone":"/wp-json/seven-tech/v1/user/change-phone",na=C.VITE_BACKEND_URL?C.VITE_BACKEND_URL+"/change-username":"/wp-json/seven-tech/v1/user/change-username",ta=C.VITE_BACKEND_URL?C.VITE_BACKEND_URL+"/change-nicename":"/wp-json/seven-tech/v1/user/change-nicename",oa=C.VITE_BACKEND_URL?C.VITE_BACKEND_URL+"/add-role":"/wp-json/seven-tech/v1/user/roles/add-role",ia=C.VITE_BACKEND_URL?C.VITE_BACKEND_URL+"/remove-role":"/wp-json/seven-tech/v1/user/roles/remove-role",ca={changeLoading:!1,changeError:"",changeSuccessMessage:"",changeErrorMessage:"",changeStatusCode:"",username:"",firstname:"",lastname:"",phone:"",nicename:"",role:""},z=M("change/changeName",function(){var t=D(w().mark(function o(r){var n,u,i,l,g,m,e;return w().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(n=r.firstName,u=r.lastName,a.prev=1,i=localStorage.getItem("email"),l=localStorage.getItem("access_token"),g=localStorage.getItem("refresh_token"),l!=""){a.next=7;break}throw new Error("An access token is required to change your name.");case 7:if(g!=""){a.next=9;break}throw Error("An refresh token is required to change your username.");case 9:if(L(i)){a.next=11;break}throw new Error("The email provided is not valid.");case 11:if(!(n==""&&u=="")){a.next=13;break}throw new Error("A first or last name is required to be changed.");case 13:return a.next=15,fetch(ra,{method:"POST",headers:{Authorization:"Bearer "+l,"Refresh-Token":g,"Content-Type":"application/json"},body:JSON.stringify({email:i,first_name:n,last_name:u})});case 15:return m=a.sent,a.next=18,m.json();case 18:return e=a.sent,a.abrupt("return",e);case 22:throw a.prev=22,a.t0=a.catch(1),console.error(a.t0),new Error(a.t0.message);case 26:case"end":return a.stop()}},o,null,[[1,22]])}));return function(o){return t.apply(this,arguments)}}()),F=M("change/changePhone",function(){var t=D(w().mark(function o(r){var n,u,i,l,g;return w().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=localStorage.getItem("email"),u=localStorage.getItem("access_token"),i=localStorage.getItem("refresh_token"),u!=""){e.next=6;break}throw Error("An access token is required to change your phone number.");case 6:if(i!=""){e.next=8;break}throw Error("An refresh token is required to change your username.");case 8:if(L(n)){e.next=10;break}throw new Error("The email provided is not valid.");case 10:if(xe(r)==!0){e.next=12;break}throw Error("There was an error changing your phone number.");case 12:return e.next=14,fetch("".concat(sa),{method:"POST",headers:{Authorization:"Bearer "+u,"Refresh-Token":i,"Content-Type":"application/json"},body:JSON.stringify({email:n,phone:r})});case 14:return l=e.sent,e.next=17,l.json();case 17:return g=e.sent,e.abrupt("return",g);case 21:throw e.prev=21,e.t0=e.catch(0),console.error(e.t0),new Error(e.t0.message);case 25:case"end":return e.stop()}},o,null,[[0,21]])}));return function(o){return t.apply(this,arguments)}}()),J=M("change/changeUsername",function(){var t=D(w().mark(function o(r){var n,u,i,l,g;return w().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=localStorage.getItem("email"),u=localStorage.getItem("access_token"),i=localStorage.getItem("refresh_token"),u!=""){e.next=6;break}throw Error("An access token is required to change your username.");case 6:if(i!=""){e.next=8;break}throw Error("An refresh token is required to change your username.");case 8:if(L(n)){e.next=10;break}throw new Error("The email provided is not valid.");case 10:if(He(r)){e.next=12;break}throw Error("Username is not valid.");case 12:return e.next=14,fetch("".concat(na),{method:"POST",headers:{Authorization:"Bearer "+u,"Refresh-Token":i,"Content-Type":"application/json"},body:JSON.stringify({email:n,username:r})});case 14:return l=e.sent,e.next=17,l.json();case 17:return g=e.sent,e.abrupt("return",g);case 21:throw e.prev=21,e.t0=e.catch(0),console.error(e.t0),new Error(e.t0.message);case 25:case"end":return e.stop()}},o,null,[[0,21]])}));return function(o){return t.apply(this,arguments)}}()),X=M("change/changeUserNicename",function(){var t=D(w().mark(function o(r){var n,u,i,l,g;return w().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=localStorage.getItem("email"),u=localStorage.getItem("access_token"),i=localStorage.getItem("refresh_token"),u!=""){e.next=6;break}throw Error("An access token is required to change your username.");case 6:if(i!=""){e.next=8;break}throw Error("An refresh token is required to change your username.");case 8:if(L(n)){e.next=10;break}throw new Error("The email provided is not valid.");case 10:if(Qe(r)){e.next=12;break}throw Error("Nice name is not valid.");case 12:return e.next=14,fetch("".concat(ta),{method:"POST",headers:{Authorization:"Bearer "+u,"Refresh-Token":i,"Content-Type":"application/json"},body:JSON.stringify({email:n,nicename:r})});case 14:return l=e.sent,e.next=17,l.json();case 17:return g=e.sent,e.abrupt("return",g);case 21:throw e.prev=21,e.t0=e.catch(0),console.error(e.t0),new Error(e.t0.message);case 25:case"end":return e.stop()}},o,null,[[0,21]])}));return function(o){return t.apply(this,arguments)}}()),Y=M("change/addUserRole",function(){var t=D(w().mark(function o(r){var n,u,i,l,g,m,e;return w().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(n=r.roleName,u=r.roleDisplayName,a.prev=1,i=localStorage.getItem("email"),l=localStorage.getItem("access_token"),g=localStorage.getItem("refresh_token"),l!=""){a.next=7;break}throw Error("An access token is required to change your role.");case 7:if(g!=""){a.next=9;break}throw Error("An refresh token is required to change your username.");case 9:if(L(i)){a.next=11;break}throw new Error("The email provided is not valid.");case 11:return a.next=13,fetch("".concat(oa),{method:"POST",headers:{Authorization:"Bearer "+l,"Refresh-Token":g,"Content-Type":"application/json"},body:JSON.stringify({email:i,role_name:n,role_display_name:u})});case 13:return m=a.sent,a.next=16,m.json();case 16:return e=a.sent,a.abrupt("return",e);case 20:throw a.prev=20,a.t0=a.catch(1),console.error(a.t0),new Error(a.t0.message);case 24:case"end":return a.stop()}},o,null,[[1,20]])}));return function(o){return t.apply(this,arguments)}}()),Z=M("change/removeUserRole",function(){var t=D(w().mark(function o(r){var n,u,i,l,g,m,e;return w().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(n=r.roleName,u=r.roleDisplayName,a.prev=1,i=localStorage.getItem("email"),l=localStorage.getItem("access_token"),g=localStorage.getItem("refresh_token"),l!=""){a.next=7;break}throw Error("An access token is required to change your role.");case 7:if(g!=""){a.next=9;break}throw Error("An refresh token is required to change your username.");case 9:if(L(i)){a.next=11;break}throw new Error("The email provided is not valid.");case 11:return a.next=13,fetch("".concat(ia),{method:"POST",headers:{Authorization:"Bearer "+l,"Refresh-Token":g,"Content-Type":"application/json"},body:JSON.stringify({email:i,role_name:n,role_display_name:u})});case 13:return m=a.sent,a.next=16,m.json();case 16:return e=a.sent,a.abrupt("return",e);case 20:throw a.prev=20,a.t0=a.catch(1),console.error(a.t0),new Error(a.t0.message);case 24:case"end":return a.stop()}},o,null,[[1,20]])}));return function(o){return t.apply(this,arguments)}}());$e({name:"change",initialState:ca,reducers:{updateChangeSuccessMessage:function(o,r){o.changeSuccessMessage=r.payload},updateChangeErrorMessage:function(o,r){o.changeError=r.payload,o.changeErrorMessage=r.payload}},extraReducers:function(o){o.addMatcher(W(z.fulfilled,F.fulfilled,J.fulfilled,X.fulfilled,Y.fulfilled,Z.fulfilled),function(r,n){r.changeLoading=!1,r.changeError="",r.changeSuccessMessage=n.payload.successMessage,r.changeErrorMessage=n.payload.errorMessage,r.changeStatusCode=n.payload.statusCode,r.username=n.payload.username,r.firstname=n.payload.firstname,r.lastname=n.payload.lastname,r.phone=n.payload.phone,r.nicename=n.payload.nicename,r.role=n.payload.role}).addMatcher(W(z.pending,F.pending,J.pending,X.pending,Y.pending,Z.pending),function(r){r.changeLoading=!0,r.changeError=null,r.changeSuccessMessage="",r.changeErrorMessage="",r.changeStatusCode=""}).addMatcher(W(z.rejected,F.rejected,J.rejected,X.rejected,Y.rejected,Z.rejected),function(r,n){r.changeLoading=!1,r.changeError=n.error,r.changeErrorMessage=n.error.message,r.changeStatusCode=n.error.code})}});function la(){var t=de(),o=N(function(d){return d.user}),r=o.changeLoading;o.changeError;var n=o.changeSuccessMessage,u=o.changeErrorMessage,i=o.changeStatusCode,l=N(function(d){return d.email}),g=l.emailLoading;l.emailError;var m=l.emailSuccessMessage,e=l.emailErrorMessage,y=l.emailStatusCode,a=N(function(d){return d.password}),B=a.passwordLoading;a.passwordError;var T=a.passwordSuccessMessage,R=a.passwordErrorMessage,j=a.passwordStatusCode,A=N(function(d){return d.logout});A.logoutLoading,A.logoutError;var b=A.logoutSuccessMessage,k=A.logoutErrorMessage,p=N(function(d){return d.account}),V=p.accountLoading;p.accountError;var I=p.accountSuccessMessage,P=p.accountErrorMessage,U=p.accountStatusCode,_=p.email,f=p.username,me=p.firstname,fe=p.lastname,pe=p.phone,ve=h.useState(me),ee=E(ve,2),G=ee[0],Se=ee[1],Ee=h.useState(fe),ae=E(Ee,2),$=ae[0],we=ae[1],Ce=h.useState(f),re=E(Ce,2),x=re[0],Ne=re[1],ke=h.useState(""),se=E(ke,2),O=se[0],ye=se[1],Te=h.useState(""),ne=E(Te,2),q=ne[0],je=ne[1],Ae=h.useState(pe),te=E(Ae,2),H=te[0],be=te[1],Ie=h.useState(""),oe=E(Ie,2);oe[0],oe[1];var Ue=h.useState(""),ie=E(Ue,2),Me=ie[0],ce=ie[1],De=h.useState(""),le=E(De,2),Le=le[0],S=le[1],Re=h.useState(""),ue=E(Re,2),K=ue[0],v=ue[1];h.useEffect(function(){(V||r||g||B)&&v("")},[t,V,r,g,B]),h.useEffect(function(){b&&(S("success"),v(b))},[t,b]),h.useEffect(function(){n&&(S("success"),v(n))},[t,n]),h.useEffect(function(){m&&(S("success"),v(m))},[t,m]),h.useEffect(function(){T&&(S("success"),v(T))},[t,T]),h.useEffect(function(){I&&(S("success"),v(I))},[t,I]),h.useEffect(function(){k&&(S("error"),v(k))},[t,k]),h.useEffect(function(){k&&(S("error"),v(k))},[t,k]),h.useEffect(function(){u&&i!=403&&(S("error"),v(u))},[t,u]),h.useEffect(function(){e&&y!=403&&(S("error"),v(e))},[t,e]),h.useEffect(function(){R&&j!=403&&(S("error"),v(R))},[t,R]),h.useEffect(function(){P&&U!=403&&(S("error"),v(P))},[t,P]),h.useEffect(function(){(i!=403||y!=403||j!=403||U!=403)&&K!=""&&(ce("modal-overlay"),setTimeout(function(){ce("")},3e3))},[t,i,y,j,U,K]);var Pe=function(c){c.preventDefault(),c.target.name=="firstname"&&Se(c.target.value)},_e=function(c){c.preventDefault(),c.target.name=="lastname"&&we(c.target.value)},Be=function(c){c.preventDefault(),(G!==""||$!=="")&&t(z({firstName:G,lastName:$})).then(function(Q){Q.payload.statusCode==201&&(t(updateAccountFirstName(Q.payload.firstname)),t(updateAccountLastName(Q.payload.lastname)))})},Ve=function(c){c.preventDefault(),c.target.name=="username"&&Ne(c.target.value)},Oe=function(c){c.preventDefault(),x!=""&&t(J(x))},he=function(c){c.preventDefault(),c.target.name=="password"&&ye(c.target.value),c.target.name=="confirmPassword"&&je(c.target.value)},qe=function(c){c.preventDefault(),O==q&&O!=""&&q!=""&&t(We({password:O,confirmPassword:q}))},Ke=function(c){c.preventDefault(),c.target.name=="phone"&&be(c.target.value)},ze=function(c){c.preventDefault(),H!=""&&t(F(H))},Fe=function(){t(Xe()).then(function(){setTimeout(function(){window.location.href="/"},5e3)})},Je=function(){ge!=null&&t(Ye()).then(function(){setTimeout(function(){window.location.href="/"},5e3)})},Ge=function(){_!=""||localStorage.getItem("email")!=""?t(Ze(_||localStorage.getItem("email"))):(S("error"),v("An email is required to remove your account."))};return s.jsx(s.Fragment,{children:s.jsxs("main",{className:"settings",children:[s.jsx("h2",{children:"Settings"}),s.jsxs("span",{className:"change-name",children:[s.jsx("input",{className:"input-name",type:"text",name:"firstname",placeholder:"First Name",value:G,onChange:Pe}),s.jsx("input",{className:"input-name",type:"text",name:"lastname",placeholder:"Last Name",value:$,onChange:_e}),s.jsx("div",{className:"action",children:s.jsx("button",{onClick:Be,children:s.jsx("h3",{children:"Change Name"})})})]}),s.jsxs("span",{className:"change-username",children:[s.jsx("input",{className:"input-username",type:"text",name:"username",placeholder:"Username",value:x,onChange:Ve}),s.jsx("div",{className:"action",children:s.jsx("button",{onClick:Oe,children:s.jsx("h3",{children:"Change Username"})})})]}),s.jsxs("span",{className:"change-phone",children:[s.jsx("input",{className:"input-phone",type:"text",name:"phone",placeholder:"Phone Number",value:H,onChange:Ke}),s.jsx("div",{className:"action",children:s.jsx("button",{onClick:ze,children:s.jsx("h3",{children:"Change Phone"})})})]}),s.jsxs("span",{className:"change-password",children:[s.jsx("input",{className:"input-password",type:"password",name:"password",placeholder:"Password",value:O,onChange:he}),s.jsx("input",{className:"input-password",type:"password",name:"confirmPassword",placeholder:"Confirm Password",value:q,onChange:he}),s.jsx("div",{className:"action",children:s.jsx("button",{onClick:qe,children:s.jsx("h3",{children:"Change Password"})})})]}),s.jsxs("span",{className:"logout",children:[s.jsx("button",{onClick:Fe,children:s.jsx("h3",{children:"LOG OUT"})}),ge!=null&&s.jsx("button",{onClick:Je,children:s.jsx("h3",{children:"LOG OUT ALL"})})]}),s.jsx("span",{className:"remove-account",children:s.jsx("button",{onClick:Ge,children:s.jsx("h3",{children:"REMOVE ACCOUNT"})})}),s.jsx("span",{className:Me,children:K!=""&&s.jsx(aa,{messageType:Le,message:K})})]})})}function ma(){var t=de(),o=N(function(f){return f.login}),r=o.profileImage,n=o.displayName,u=r||localStorage.getItem("profile_image"),i=n||localStorage.getItem("display_name"),l=N(function(f){return f.user}),g=l.changeStatusCode,m=N(function(f){return f.email}),e=m.emailStatusCode,y=N(function(f){return f.password}),a=y.passwordStatusCode,B=N(function(f){return f.login}),T=B.loginStatusCode,R=N(function(f){return f.account}),j=R.accountStatusCode,A=h.useState(""),b=E(A,2),k=b[0],p=b[1],V=h.useState(!1),I=E(V,2),P=I[0],U=I[1];h.useEffect(function(){T==200&&U(!1)},[T]),h.useEffect(function(){(g==403||e==403||a==403||j==403)&&U(!0)},[t,g,e,a,j]);var _=function(){k==!1&&p(!0),k==!0&&p(!1)};return s.jsxs(s.Fragment,{children:[s.jsx("h2",{className:"title",children:"Dashboard"}),s.jsxs("div",{className:"header",children:[s.jsx("div",{className:"profile-image",children:s.jsx("img",{src:"".concat(u),alt:""})}),s.jsx("h2",{className:"display-name",children:i}),s.jsx("div",{className:"options",children:s.jsx("button",{className:"settings-button",onClick:_,children:s.jsx("i",{class:"fa-solid fa-gears"})})})]}),k&&s.jsx(la,{}),P&&s.jsx("div",{className:"modal-overlay",children:s.jsx("main",{className:"login",children:s.jsx(ea,{})})})]})}export{ma as default};
//# sourceMappingURL=Dashboard.js.map

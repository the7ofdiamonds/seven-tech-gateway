import{f as j,g as ra,i as W,c as T,d as p,h as na,k as b,m as fe,n as sa,u as k,r as m,_ as w,j as r,o as ge,p as ta,l as oa,q as ia,t as ca}from"./index.js";import ua from"./Login.js";import{u as pe,S as la}from"./StatusBarComponent.js";import"./NavigationLoginComponent.js";var v={VITE_API_KEY:"AIzaSyBu0CCToizQh2SORCP-4dAmXHJpzB6tU6k",VITE_AUTH_DOMAIN:"theorb-f3a48.firebaseapp.com",VITE_DATABASE_URL:"https://theorb-f3a48.firebaseio.com",VITE_PROJECT_ID:"theorb-f3a48",VITE_STORAGE_BUCKET:"theorb-f3a48.appspot.com",VITE_MESSAGING_SENDER_ID:"1073451047758",VITE_APP_ID:"1:1073451047758:web:ae958815b1fd677e071c1f",VITE_MEASUREMENT_ID:"G-09W10PNNF0",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},ha=v.VITE_BACKEND_URL?v.VITE_BACKEND_URL+"/change-name":"/wp-json/seven-tech/v1/user/change-name",ma=v.VITE_BACKEND_URL?v.VITE_BACKEND_URL+"/change-phone":"/wp-json/seven-tech/v1/user/change-phone",da=v.VITE_BACKEND_URL?v.VITE_BACKEND_URL+"/change-username":"/wp-json/seven-tech/v1/user/change-username",ga=v.VITE_BACKEND_URL?v.VITE_BACKEND_URL+"/change-nickname":"/wp-json/seven-tech/v1/user/change-nickname",fa=v.VITE_BACKEND_URL?v.VITE_BACKEND_URL+"/change-nicename":"/wp-json/seven-tech/v1/user/change-nicename",pa=v.VITE_BACKEND_URL?v.VITE_BACKEND_URL+"/add-role":"/wp-json/seven-tech/v1/user/roles/add-role",va=v.VITE_BACKEND_URL?v.VITE_BACKEND_URL+"/remove-role":"/wp-json/seven-tech/v1/user/roles/remove-role",Sa={changeLoading:!1,changeError:"",changeSuccessMessage:"",changeErrorMessage:"",changeStatusCode:"",username:"",firstname:"",lastname:"",phone:"",nicename:"",role:""},z=j("change/changeUsername",function(){var t=T(p().mark(function i(n){var s,u,c,l,h;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,s=localStorage.getItem("email"),u=localStorage.getItem("access_token"),c=localStorage.getItem("refresh_token"),u!=""){e.next=6;break}throw Error("An access token is required to change your username.");case 6:if(c!=""){e.next=8;break}throw Error("An refresh token is required to change your username.");case 8:if(b(s)){e.next=10;break}throw new Error("The email provided is not valid.");case 10:if(na(n)){e.next=12;break}throw Error("Username is not valid.");case 12:return e.next=14,fetch("".concat(da),{method:"POST",headers:{Authorization:"Bearer "+u,"Refresh-Token":c,"Content-Type":"application/json"},body:JSON.stringify({email:s,username:n})});case 14:return l=e.sent,e.next=17,l.json();case 17:return h=e.sent,e.abrupt("return",h);case 21:throw e.prev=21,e.t0=e.catch(0),console.error(e.t0),new Error(e.t0.message);case 25:case"end":return e.stop()}},i,null,[[0,21]])}));return function(i){return t.apply(this,arguments)}}()),J=j("change/changeName",function(){var t=T(p().mark(function i(n){var s,u,c,l,h,g,e;return p().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(s=n.firstName,u=n.lastName,a.prev=1,c=localStorage.getItem("email"),l=localStorage.getItem("access_token"),h=localStorage.getItem("refresh_token"),l!=""){a.next=7;break}throw new Error("An access token is required to change your name.");case 7:if(h!=""){a.next=9;break}throw Error("An refresh token is required to change your username.");case 9:if(b(c)){a.next=11;break}throw new Error("The email provided is not valid.");case 11:if(!(s==""&&u=="")){a.next=13;break}throw new Error("A first or last name is required to be changed.");case 13:return a.next=15,fetch(ha,{method:"POST",headers:{Authorization:"Bearer "+l,"Refresh-Token":h,"Content-Type":"application/json"},body:JSON.stringify({email:c,first_name:s,last_name:u})});case 15:return g=a.sent,a.next=18,g.json();case 18:return e=a.sent,a.abrupt("return",e);case 22:throw a.prev=22,a.t0=a.catch(1),console.error(a.t0),new Error(a.t0.message);case 26:case"end":return a.stop()}},i,null,[[1,22]])}));return function(i){return t.apply(this,arguments)}}()),Ea=j("change/changeNickname",function(){var t=T(p().mark(function i(n){var s,u,c,l,h;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,s=localStorage.getItem("email"),u=localStorage.getItem("access_token"),c=localStorage.getItem("refresh_token"),u!=""){e.next=6;break}throw Error("An access token is required to change your username.");case 6:if(c!=""){e.next=8;break}throw Error("An refresh token is required to change your username.");case 8:if(b(s)){e.next=10;break}throw new Error("The email provided is not valid.");case 10:if(fe(n)){e.next=12;break}throw Error("Nick name is not valid.");case 12:return e.next=14,fetch("".concat(ga),{method:"POST",headers:{Authorization:"Bearer "+u,"Refresh-Token":c,"Content-Type":"application/json"},body:JSON.stringify({email:s,nicename:n})});case 14:return l=e.sent,e.next=17,l.json();case 17:return h=e.sent,e.abrupt("return",h);case 21:throw e.prev=21,e.t0=e.catch(0),console.error(e.t0),new Error(e.t0.message);case 25:case"end":return e.stop()}},i,null,[[0,21]])}));return function(i){return t.apply(this,arguments)}}()),wa=j("change/changeNicename",function(){var t=T(p().mark(function i(n){var s,u,c,l,h;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,s=localStorage.getItem("email"),u=localStorage.getItem("access_token"),c=localStorage.getItem("refresh_token"),u!=""){e.next=6;break}throw Error("An access token is required to change your username.");case 6:if(c!=""){e.next=8;break}throw Error("An refresh token is required to change your username.");case 8:if(b(s)){e.next=10;break}throw new Error("The email provided is not valid.");case 10:if(fe(n)){e.next=12;break}throw Error("Nice name is not valid.");case 12:return e.next=14,fetch("".concat(fa),{method:"POST",headers:{Authorization:"Bearer "+u,"Refresh-Token":c,"Content-Type":"application/json"},body:JSON.stringify({email:s,nicename:n})});case 14:return l=e.sent,e.next=17,l.json();case 17:return h=e.sent,e.abrupt("return",h);case 21:throw e.prev=21,e.t0=e.catch(0),console.error(e.t0),new Error(e.t0.message);case 25:case"end":return e.stop()}},i,null,[[0,21]])}));return function(i){return t.apply(this,arguments)}}()),X=j("change/addUserRole",function(){var t=T(p().mark(function i(n){var s,u,c,l,h,g,e;return p().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(s=n.roleName,u=n.roleDisplayName,a.prev=1,c=localStorage.getItem("email"),l=localStorage.getItem("access_token"),h=localStorage.getItem("refresh_token"),l!=""){a.next=7;break}throw Error("An access token is required to change your role.");case 7:if(h!=""){a.next=9;break}throw Error("An refresh token is required to change your username.");case 9:if(b(c)){a.next=11;break}throw new Error("The email provided is not valid.");case 11:return a.next=13,fetch("".concat(pa),{method:"POST",headers:{Authorization:"Bearer "+l,"Refresh-Token":h,"Content-Type":"application/json"},body:JSON.stringify({email:c,role_name:s,role_display_name:u})});case 13:return g=a.sent,a.next=16,g.json();case 16:return e=a.sent,a.abrupt("return",e);case 20:throw a.prev=20,a.t0=a.catch(1),console.error(a.t0),new Error(a.t0.message);case 24:case"end":return a.stop()}},i,null,[[1,20]])}));return function(i){return t.apply(this,arguments)}}()),Y=j("change/removeUserRole",function(){var t=T(p().mark(function i(n){var s,u,c,l,h,g,e;return p().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(s=n.roleName,u=n.roleDisplayName,a.prev=1,c=localStorage.getItem("email"),l=localStorage.getItem("access_token"),h=localStorage.getItem("refresh_token"),l!=""){a.next=7;break}throw Error("An access token is required to change your role.");case 7:if(h!=""){a.next=9;break}throw Error("An refresh token is required to change your username.");case 9:if(b(c)){a.next=11;break}throw new Error("The email provided is not valid.");case 11:return a.next=13,fetch("".concat(va),{method:"POST",headers:{Authorization:"Bearer "+l,"Refresh-Token":h,"Content-Type":"application/json"},body:JSON.stringify({email:c,role_name:s,role_display_name:u})});case 13:return g=a.sent,a.next=16,g.json();case 16:return e=a.sent,a.abrupt("return",e);case 20:throw a.prev=20,a.t0=a.catch(1),console.error(a.t0),new Error(a.t0.message);case 24:case"end":return a.stop()}},i,null,[[1,20]])}));return function(i){return t.apply(this,arguments)}}()),F=j("change/changePhone",function(){var t=T(p().mark(function i(n){var s,u,c,l,h;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,s=localStorage.getItem("email"),u=localStorage.getItem("access_token"),c=localStorage.getItem("refresh_token"),u!=""){e.next=6;break}throw Error("An access token is required to change your phone number.");case 6:if(c!=""){e.next=8;break}throw Error("An refresh token is required to change your username.");case 8:if(b(s)){e.next=10;break}throw new Error("The email provided is not valid.");case 10:if(sa(n)==!0){e.next=12;break}throw Error("There was an error changing your phone number.");case 12:return e.next=14,fetch("".concat(ma),{method:"POST",headers:{Authorization:"Bearer "+u,"Refresh-Token":c,"Content-Type":"application/json"},body:JSON.stringify({email:s,phone:n})});case 14:return l=e.sent,e.next=17,l.json();case 17:return h=e.sent,e.abrupt("return",h);case 21:throw e.prev=21,e.t0=e.catch(0),console.error(e.t0),new Error(e.t0.message);case 25:case"end":return e.stop()}},i,null,[[0,21]])}));return function(i){return t.apply(this,arguments)}}());ra({name:"change",initialState:Sa,reducers:{updateChangeSuccessMessage:function(i,n){i.changeSuccessMessage=n.payload},updateChangeErrorMessage:function(i,n){i.changeError=n.payload,i.changeErrorMessage=n.payload}},extraReducers:function(i){i.addMatcher(W(J.fulfilled,F.fulfilled,z.fulfilled,changeUserNicename.fulfilled,X.fulfilled,Y.fulfilled),function(n,s){n.changeLoading=!1,n.changeError="",n.changeSuccessMessage=s.payload.successMessage,n.changeErrorMessage=s.payload.errorMessage,n.changeStatusCode=s.payload.statusCode,n.username=s.payload.username,n.firstname=s.payload.firstname,n.lastname=s.payload.lastname,n.phone=s.payload.phone,n.nicename=s.payload.nicename,n.role=s.payload.role}).addMatcher(W(J.pending,F.pending,z.pending,changeUserNicename.pending,X.pending,Y.pending),function(n){n.changeLoading=!0,n.changeError=null,n.changeSuccessMessage="",n.changeErrorMessage="",n.changeStatusCode=""}).addMatcher(W(J.rejected,F.rejected,z.rejected,changeUserNicename.rejected,X.rejected,Y.rejected),function(n,s){n.changeLoading=!1,n.changeError=s.error,n.changeErrorMessage=s.error.message,n.changeStatusCode=s.error.code})}});function Na(){var t=pe(),i=k(function(d){return d.user}),n=i.changeLoading;i.changeError;var s=i.changeSuccessMessage,u=i.changeErrorMessage,c=i.changeStatusCode,l=k(function(d){return d.email}),h=l.emailLoading;l.emailError;var g=l.emailSuccessMessage,e=l.emailErrorMessage,y=l.emailStatusCode,a=k(function(d){return d.password}),O=a.passwordLoading;a.passwordError;var A=a.passwordSuccessMessage,R=a.passwordErrorMessage,I=a.passwordStatusCode,D=k(function(d){return d.logout});D.logoutLoading,D.logoutError;var U=D.logoutSuccessMessage,C=D.logoutErrorMessage,S=k(function(d){return d.account}),V=S.accountLoading;S.accountError;var L=S.accountSuccessMessage,P=S.accountErrorMessage,M=S.accountStatusCode,B=S.email,f=S.username,ve=S.firstname,Se=S.lastname,Ee=S.phone,we=m.useState(""),Z=w(we,2),_=Z[0],Ne=Z[1],ke=m.useState(""),ee=w(ke,2),q=ee[0],Ce=ee[1],ye=m.useState(f),ae=w(ye,2),x=ae[0],je=ae[1],Te=m.useState(ve),re=w(Te,2),G=re[0],be=re[1],Ae=m.useState(Se),ne=w(Ae,2),$=ne[0],Ie=ne[1],De=m.useState(nickname),se=w(De,2),te=se[0],Ue=se[1],Le=m.useState(nicename),oe=w(Le,2),ie=oe[0],Me=oe[1],Re=m.useState(Ee),ce=w(Re,2),H=ce[0],Pe=ce[1],Be=m.useState(""),ue=w(Be,2),Oe=ue[0],le=ue[1],Ve=m.useState(""),he=w(Ve,2),_e=he[0],N=he[1],qe=m.useState(""),me=w(qe,2),K=me[0],E=me[1];m.useEffect(function(){(V||n||h||O)&&E("")},[t,V,n,h,O]),m.useEffect(function(){U&&(N("success"),E(U))},[t,U]),m.useEffect(function(){s&&(N("success"),E(s))},[t,s]),m.useEffect(function(){g&&(N("success"),E(g))},[t,g]),m.useEffect(function(){A&&(N("success"),E(A))},[t,A]),m.useEffect(function(){L&&(N("success"),E(L))},[t,L]),m.useEffect(function(){C&&(N("error"),E(C))},[t,C]),m.useEffect(function(){C&&(N("error"),E(C))},[t,C]),m.useEffect(function(){u&&c!=403&&(N("error"),E(u))},[t,u]),m.useEffect(function(){e&&y!=403&&(N("error"),E(e))},[t,e]),m.useEffect(function(){R&&I!=403&&(N("error"),E(R))},[t,R]),m.useEffect(function(){P&&M!=403&&(N("error"),E(P))},[t,P]),m.useEffect(function(){(c!=403||y!=403||I!=403||M!=403)&&K!=""&&(le("modal-overlay"),setTimeout(function(){le("")},3e3))},[t,c,y,I,M,K]);var de=function(o){o.preventDefault(),o.target.name=="password"&&Ne(o.target.value),o.target.name=="confirmPassword"&&Ce(o.target.value)},Ke=function(o){o.preventDefault(),_==q&&_!=""&&q!=""&&t(ta({password:_,confirmPassword:q}))},ze=function(o){o.preventDefault(),o.target.name=="username"&&je(o.target.value)},Je=function(o){o.preventDefault(),x!=""&&t(z(x))},Fe=function(o){o.preventDefault(),o.target.name=="firstname"&&be(o.target.value)},xe=function(o){o.preventDefault(),o.target.name=="lastname"&&Ie(o.target.value)},Ge=function(o){o.preventDefault(),(G!==""||$!=="")&&t(J({firstName:G,lastName:$})).then(function(Q){Q.payload.statusCode==201&&(t(updateAccountFirstName(Q.payload.firstname)),t(updateAccountLastName(Q.payload.lastname)))})},$e=function(o){o.preventDefault(),o.target.name=="nickname"&&Ue(o.target.value)},He=function(o){o.preventDefault(),te!=""&&t(Ea(te))},Qe=function(o){o.preventDefault(),o.target.name=="nicename"&&Me(o.target.value)},We=function(o){o.preventDefault(),ie!=""&&t(wa(ie))},Xe=function(o){o.preventDefault(),o.target.name=="phone"&&Pe(o.target.value)},Ye=function(o){o.preventDefault(),H!=""&&t(F(H))},Ze=function(){t(oa()).then(function(){setTimeout(function(){window.location.href="/"},5e3)})},ea=function(){ge!=null&&t(ia()).then(function(){setTimeout(function(){window.location.href="/"},5e3)})},aa=function(){B!=""||localStorage.getItem("email")!=""?t(ca(B||localStorage.getItem("email"))):(N("error"),E("An email is required to lock your account."))};return r.jsx(r.Fragment,{children:r.jsxs("main",{className:"settings",children:[r.jsx("h2",{children:"Settings"}),r.jsxs("span",{className:"change-password",children:[r.jsx("input",{className:"input-password",type:"password",name:"password",placeholder:"Password",value:_,onChange:de}),r.jsx("input",{className:"input-password",type:"password",name:"confirmPassword",placeholder:"Confirm Password",value:q,onChange:de}),r.jsx("div",{className:"action",children:r.jsx("button",{onClick:Ke,children:r.jsx("h3",{children:"Change Password"})})})]}),r.jsxs("span",{className:"change-username",children:[r.jsx("input",{className:"input-username",type:"text",name:"username",placeholder:"Username",value:x,onChange:ze}),r.jsx("div",{className:"action",children:r.jsx("button",{onClick:Je,children:r.jsx("h3",{children:"Change Username"})})})]}),r.jsxs("span",{className:"change-name",children:[r.jsx("input",{className:"input-name",type:"text",name:"firstname",placeholder:"First Name",value:G,onChange:Fe}),r.jsx("input",{className:"input-name",type:"text",name:"lastname",placeholder:"Last Name",value:$,onChange:xe}),r.jsx("div",{className:"action",children:r.jsx("button",{onClick:Ge,children:r.jsx("h3",{children:"Change Name"})})})]}),r.jsxs("span",{className:"change-nickname",children:[r.jsx("input",{className:"input-name",type:"text",name:"nickname",placeholder:"Nickname",value:nickname,onChange:$e}),r.jsx("div",{className:"action",children:r.jsx("button",{onClick:He,children:r.jsx("h3",{children:"Change Nickname"})})})]}),r.jsxs("span",{className:"change-nicename",children:[r.jsx("input",{className:"input-name",type:"text",name:"nicename",placeholder:"Nicename",value:nicename,onChange:Qe}),r.jsx("div",{className:"action",children:r.jsx("button",{onClick:We,children:r.jsx("h3",{children:"Change Nicename"})})})]}),r.jsxs("span",{className:"change-phone",children:[r.jsx("input",{className:"input-phone",type:"text",name:"phone",placeholder:"Phone Number",value:H,onChange:Xe}),r.jsx("div",{className:"action",children:r.jsx("button",{onClick:Ye,children:r.jsx("h3",{children:"Change Phone"})})})]}),r.jsxs("span",{className:"logout",children:[r.jsx("button",{onClick:Ze,children:r.jsx("h3",{children:"LOG OUT"})}),ge!=null&&r.jsx("button",{onClick:ea,children:r.jsx("h3",{children:"LOG OUT ALL"})})]}),r.jsx("span",{className:"lock-account",children:r.jsx("button",{onClick:aa,children:r.jsx("h3",{children:"LOCK ACCOUNT"})})}),r.jsx("span",{className:Oe,children:K!=""&&r.jsx(la,{messageType:_e,message:K})})]})})}function Ta(){var t=pe(),i=k(function(f){return f.login}),n=i.profileImage,s=i.displayName,u=n||localStorage.getItem("profile_image"),c=s||localStorage.getItem("display_name"),l=k(function(f){return f.user}),h=l.changeStatusCode,g=k(function(f){return f.email}),e=g.emailStatusCode,y=k(function(f){return f.password}),a=y.passwordStatusCode,O=k(function(f){return f.login}),A=O.loginStatusCode,R=k(function(f){return f.account}),I=R.accountStatusCode,D=m.useState(""),U=w(D,2),C=U[0],S=U[1],V=m.useState(!1),L=w(V,2),P=L[0],M=L[1];m.useEffect(function(){A==200&&M(!1)},[A]),m.useEffect(function(){(h==403||e==403||a==403||I==403)&&M(!0)},[t,h,e,a,I]);var B=function(){C==!1&&S(!0),C==!0&&S(!1)};return r.jsxs(r.Fragment,{children:[r.jsx("h2",{className:"title",children:"Dashboard"}),r.jsxs("div",{className:"header",children:[r.jsx("div",{className:"profile-image",children:r.jsx("img",{src:"".concat(u),alt:""})}),r.jsx("h2",{className:"display-name",children:c}),r.jsx("div",{className:"options",children:r.jsx("button",{className:"settings-button",onClick:B,children:r.jsx("i",{class:"fa-solid fa-gears"})})})]}),C&&r.jsx(Na,{}),P&&r.jsx("div",{className:"modal-overlay",children:r.jsx("main",{className:"login",children:r.jsx(ua,{})})})]})}export{Ta as default};
//# sourceMappingURL=Dashboard.js.map

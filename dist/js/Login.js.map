{"version":3,"file":"Login.js","sources":["../../src/views/Login.jsx"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\n\nimport NavigationComponent from './components/NavigationLogin';\n\nimport {\n  signIn,\n  updateAccessToken,\n  updateRefreshToken,\n} from '../controllers/loginSlice';\n\nimport {\n  onAuthStateChanged,\n  getAuth,\n  GoogleAuthProvider,\n  OAuthProvider,\n  signInWithPopup,\n  signInWithCustomToken,\n} from 'firebase/auth';\n\nconst firebaseAuth = getAuth();\nconst google = new GoogleAuthProvider();\nconst microsoft = new OAuthProvider('microsoft.com');\nconst apple = new OAuthProvider('apple');\n\nfunction LoginComponent() {\n  let page = 'login';\n\n  const dispatch = useDispatch();\n\n  const {\n    loginMessage,\n    loginMessageType,\n    loginError,\n    customToken,\n    accessToken,\n    refreshToken,\n    display_name,\n    firebaseUserID,\n  } = useSelector((state) => state.login);\n\n  const [formData, setFormData] = useState({\n    username: display_name,\n    password: '',\n  });\n  const [messageType, setMessageType] = useState('');\n  const [message, setMessage] = useState(\n    'Enter your email and password to log in.'\n  );\n\n  useEffect(() => {\n    if (loginMessage && loginMessageType) {\n      setMessage(loginMessage);\n      setMessageType(loginMessageType);\n    }\n  }, [loginMessage, loginMessageType]);\n\n  useEffect(() => {\n    if (customToken) {\n      signInWithCustomToken(firebaseAuth, customToken).then((signedInUser) => {\n        signedInUser.user.getIdToken().then((accessToken) => {\n          localStorage.setItem('access_token', accessToken);\n          dispatch(updateAccessToken(accessToken));\n        });\n\n        const refreshToken = signedInUser.user.refreshToken;\n        const displayName = signedInUser.user.displayName;\n\n        localStorage.setItem('refresh_token', refreshToken);\n        localStorage.setItem('display_name', displayName);\n\n        dispatch(updateRefreshToken(refreshToken));\n      });\n    }\n  }, [customToken]);\n  console.log(accessToken);\n  console.log(refreshToken);\n  useEffect(() => {\n    if (accessToken && refreshToken) {\n      return onAuthStateChanged(firebaseAuth, () => {\n        const urlParams = new URLSearchParams(window.location.search);\n        const redirectTo = urlParams.get('redirectTo');\n\n        setMessage(loginMessage);\n        setMessageType(loginMessageType);\n\n        setTimeout(() => {\n          if (redirectTo == null) {\n            window.location.href = '/dashboard';\n          } else {\n            window.location.href = redirectTo;\n          }\n        }, 5000);\n      });\n    }\n  }, [accessToken, refreshToken]);\n\n  const handleInputChange = (e) => {\n    const { name, value } = e.target;\n    setFormData({\n      ...formData,\n      [name]: value,\n    });\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    dispatch(\n      signIn({ username: formData.username, password: formData.password })\n    );\n  };\n\n  const handleGoogleSignIn = async () => {\n    await signInWithPopup(firebaseAuth, google);\n  };\n\n  const handleMicrosoftSignIn = async () => {\n    await signInWithPopup(firebaseAuth, microsoft);\n  };\n\n  const handleAppleSignIn = async () => {\n    await signInWithPopup(firebaseAuth, apple);\n  };\n\n  return (\n    <>\n      <main className=\"login\">\n        <NavigationComponent page={page} />\n\n        <div className=\"login card\">\n          <form onSubmit={handleSubmit}>\n            <table>\n              <thead></thead>\n              <tbody>\n                <tr>\n                  <td>\n                    <input\n                      type=\"text\"\n                      name=\"username\"\n                      placeholder=\"Username\"\n                      value={formData.username}\n                      onChange={handleInputChange}\n                      required\n                    />\n                  </td>\n                </tr>\n                <tr>\n                  <td>\n                    <input\n                      type=\"password\"\n                      name=\"password\"\n                      placeholder=\"Password\"\n                      value={formData.password}\n                      onChange={handleInputChange}\n                      required\n                    />\n                  </td>\n                </tr>\n              </tbody>\n              <tfoot>\n                <tr>\n                  <td>\n                    <button type=\"submit\">\n                      <h3>LOGIN</h3>\n                    </button>\n                  </td>\n                </tr>\n              </tfoot>\n            </table>\n          </form>\n        </div>\n\n        <div className=\"actions\">\n          <button className=\"login-button google\" onClick={handleGoogleSignIn}>\n            <svg\n              xmlns=\"http://www.w3.org/2000/svg\"\n              height=\"24\"\n              viewBox=\"0 0 24 24\"\n              width=\"24\">\n              <path\n                d=\"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z\"\n                fill=\"#4285F4\"\n              />\n              <path\n                d=\"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z\"\n                fill=\"#34A853\"\n              />\n              <path\n                d=\"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z\"\n                fill=\"#FBBC05\"\n              />\n              <path\n                d=\"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z\"\n                fill=\"#EA4335\"\n              />\n              <path d=\"M1 1h22v22H1z\" fill=\"none\" />\n            </svg>\n            <h3>Login with Google</h3>\n          </button>\n\n          <button\n            className=\"login-button microsoft\"\n            onClick={handleMicrosoftSignIn}>\n            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 21 21\">\n              <path fill=\"#f35325\" d=\"M0 0h10v10H0z\" />\n              <path fill=\"#81bc06\" d=\"M11 0h10v10H11z\" />\n              <path fill=\"#05a6f0\" d=\"M0 11h10v10H0z\" />\n              <path fill=\"#ffba08\" d=\"M11 11h10v10H11z\" />\n            </svg>\n            <h3>Login with Microsoft</h3>\n          </button>\n\n          <button className=\"login-button apple\" onClick={handleAppleSignIn}>\n            <svg\n              xmlns=\"http://www.w3.org/2000/svg\"\n              width=\"170px\"\n              viewBox=\"0 0 170 170\"\n              version=\"1.1\"\n              height=\"170px\">\n              <path\n                d=\"m150.37 130.25c-2.45 5.66-5.35 10.87-8.71 15.66-4.58 6.53-8.33 11.05-11.22 13.56-4.48 4.12-9.28 6.23-14.42 6.35-3.69 0-8.14-1.05-13.32-3.18-5.197-2.12-9.973-3.17-14.34-3.17-4.58 0-9.492 1.05-14.746 3.17-5.262 2.13-9.501 3.24-12.742 3.35-4.929 0.21-9.842-1.96-14.746-6.52-3.13-2.73-7.045-7.41-11.735-14.04-5.032-7.08-9.169-15.29-12.41-24.65-3.471-10.11-5.211-19.9-5.211-29.378 0-10.857 2.346-20.221 7.045-28.068 3.693-6.303 8.606-11.275 14.755-14.925s12.793-5.51 19.948-5.629c3.915 0 9.049 1.211 15.429 3.591 6.362 2.388 10.447 3.599 12.238 3.599 1.339 0 5.877-1.416 13.57-4.239 7.275-2.618 13.415-3.702 18.445-3.275 13.63 1.1 23.87 6.473 30.68 16.153-12.19 7.386-18.22 17.731-18.1 31.002 0.11 10.337 3.86 18.939 11.23 25.769 3.34 3.17 7.07 5.62 11.22 7.36-0.9 2.61-1.85 5.11-2.86 7.51zm-31.26-123.01c0 8.1021-2.96 15.667-8.86 22.669-7.12 8.324-15.732 13.134-25.071 12.375-0.119-0.972-0.188-1.995-0.188-3.07 0-7.778 3.386-16.102 9.399-22.908 3.002-3.446 6.82-6.3113 11.45-8.597 4.62-2.2516 8.99-3.4968 13.1-3.71 0.12 1.0831 0.17 2.1663 0.17 3.2409z\"\n                fill=\"#FFF\"\n              />\n            </svg>\n            <h3>Login with Apple</h3>\n          </button>\n        </div>\n\n        {message !== '' && (\n          <div className={`status-bar card ${messageType}`}>\n            <span>\n              <div dangerouslySetInnerHTML={{ __html: message }} />\n            </span>\n          </div>\n        )}\n      </main>\n    </>\n  );\n}\n\nexport default LoginComponent;\n"],"names":["firebaseAuth","getAuth","google","GoogleAuthProvider","microsoft","OAuthProvider","apple","LoginComponent","page","dispatch","useDispatch","_useSelector","useSelector","state","login","loginMessage","loginMessageType","loginError","customToken","accessToken","refreshToken","display_name","firebaseUserID","_useState","useState","username","password","_useState2","_slicedToArray","formData","setFormData","_useState3","_useState4","messageType","setMessageType","_useState5","_useState6","message","setMessage","useEffect","signInWithCustomToken","then","signedInUser","user","getIdToken","localStorage","setItem","updateAccessToken","displayName","updateRefreshToken","console","log","onAuthStateChanged","urlParams","URLSearchParams","window","location","search","redirectTo","get","setTimeout","href","handleInputChange","e","_e$target","target","name","value","_objectSpread","_defineProperty","handleSubmit","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_context","prev","next","preventDefault","signIn","stop","_x","apply","arguments","handleGoogleSignIn","_callee2","_context2","signInWithPopup","handleMicrosoftSignIn","_callee3","_context3","handleAppleSignIn","_callee4","_context4","jsx","Fragment","children","jsxs","className","NavigationComponent","onSubmit","type","placeholder","onChange","required","onClick","xmlns","height","viewBox","width","d","fill","version","concat","dangerouslySetInnerHTML","__html"],"mappings":"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"}